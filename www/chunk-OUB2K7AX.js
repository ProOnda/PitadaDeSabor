import"./chunk-COZSD6FY.js";import{a as oe}from"./chunk-7NVNJO5G.js";import{a as te}from"./chunk-AKOWJJL3.js";import{a as Z}from"./chunk-IVYJ7RYW.js";import{a as X}from"./chunk-TJ4WWLIQ.js";import"./chunk-VHRLFIFT.js";import{b as ee}from"./chunk-RO3PRQET.js";import"./chunk-TF2KOS4Q.js";import"./chunk-B646OTCI.js";import"./chunk-7JSI5SCB.js";import"./chunk-Z3CHXUHI.js";import"./chunk-HC6MZPB3.js";import"./chunk-IP3IRUG3.js";import"./chunk-FYKNTBE2.js";import"./chunk-RMJ7PCZJ.js";import"./chunk-OFKYDT3Y.js";import"./chunk-SJBLRW5X.js";import{a as Y}from"./chunk-4EICRDDQ.js";import"./chunk-CARB67EU.js";import"./chunk-XXKETIBL.js";import"./chunk-GNOVVPTF.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-JFFBAPXU.js";import"./chunk-MCRJI3T3.js";import"./chunk-BAKMWPBW.js";import"./chunk-O5PN56JD.js";import"./chunk-P4K7NQPT.js";import"./chunk-BL7BDUKV.js";import{$ as m,Aa as V,Eb as W,H as w,I as y,Ia as S,Ja as D,Ka as $,R as I,S as a,Sa as G,Ta as q,V as _,Va as K,Wa as H,X as N,Xa as J,a as E,bb as Q,ca as p,d as k,ha as s,ia as l,ja as u,ka as A,l as T,la as L,m as R,na as U,oa as v,pa as f,r as z,s as j,sa as B,t as O,v as b,ya as g,za as C}from"./chunk-J7TXCJLH.js";import"./chunk-CTXH4QH2.js";import"./chunk-A4HHE4W2.js";import"./chunk-LFRXSQAQ.js";import"./chunk-GK6EN35L.js";import"./chunk-II53MLED.js";import"./chunk-RUL3GU37.js";import"./chunk-WTCPO44B.js";import"./chunk-SV7S5NYR.js";import{g as x}from"./chunk-OLRFWS6T.js";function ie(o,n){o&1&&(s(0,"div",20),u(1,"i",21)(2,"i",22),l())}function ne(o,n){if(o&1&&u(0,"img",23),o&2){let r=f();p("src",r.profileImagePreviewUrl,I)}}function re(o,n){if(o&1){let r=U();s(0,"button",24),v("click",function(){w(r);let i=f();return y(i.onSaveProfilePhoto())}),g(1," Salvar Foto de Perfil "),l()}}function ae(o,n){o&1&&(s(0,"p",25),g(1,"Carregando suas receitas..."),l())}function le(o,n){if(o&1&&(s(0,"p",26),g(1),l()),o&2){let r=f();a(),C(r.error)}}function se(o,n){if(o&1){let r=U();s(0,"div",31),v("click",function(){let i=w(r).$implicit,t=f(3);return y(t.navigateToRecipeDetail(i.id))}),s(1,"div",32),u(2,"img",33),l(),s(3,"div",34)(4,"h5",35),g(5),l(),s(6,"p",36),g(7),S(8,"date"),l()()()}if(o&2){let r=n.$implicit;a(2),B("alt",r.recipeName),p("src",r.photoUrl||"https://placehold.co/311x229",I),a(3),C(r.recipeName),a(2),C($(8,4,r.createdAt,"mediumDate"))}}function ce(o,n){if(o&1&&(s(0,"div",29),m(1,se,9,7,"div",30),l()),o&2){let r=f().ngIf;a(),p("ngForOf",r)}}function pe(o,n){o&1&&(s(0,"p",37),g(1," Voc\xEA ainda n\xE3o criou nenhuma receita. Que tal compartilhar uma? "),l())}function ge(o,n){if(o&1&&(A(0),m(1,ce,2,1,"div",27)(2,pe,2,0,"p",28),L()),o&2){let r=n.ngIf,e=f();a(),p("ngIf",!e.isLoading&&r.length>0),a(),p("ngIf",!e.isLoading&&!e.error&&r.length===0)}}var Se=(()=>{let n=class n{constructor(e,i,t,c){this.authService=e,this.receitaService=i,this.router=t,this.imageCompress=c,this.userName=null,this.userPhotoUrl=null,this.postsCount=null,this.isLoading=!0,this.error=null,this.profileImagePreviewUrl=null,this.selectedProfileFile=null,this.currentUserId=null,this.userRecipesSubject=new k([]),this.userRecipes$=this.userRecipesSubject.asObservable(),this.subscriptions=new E}ngOnInit(){this.loadUserProfileAndRecipes()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadUserProfileAndRecipes(){this.isLoading=!0,this.error=null,this.subscriptions.add(this.authService.authState.pipe(z(e=>!!(e!=null&&e.uid)),O(e=>{let i=e.uid;return this.currentUserId=i,this.authService.getCurrentUserData(i).pipe(b(t=>{t?(this.userName=t.user_name||t.displayName||"Usu\xE1rio",this.userPhotoUrl=t.photoURL||"https://placehold.co/100x100",this.userPhotoUrl==="https://placehold.co/100x100"||!t.photoURL?this.profileImagePreviewUrl=null:this.profileImagePreviewUrl=this.userPhotoUrl):(this.userName="Usu\xE1rio Desconhecido",this.userPhotoUrl="https://placehold.co/100x100",this.profileImagePreviewUrl=null)}),O(()=>this.receitaService.getRecipesByCreator(i)))}),b(e=>{this.userRecipesSubject.next(e),this.postsCount=e.length,this.isLoading=!1}),j(e=>(console.error("Erro ao carregar perfil ou receitas:",e),this.error="N\xE3o foi poss\xEDvel carregar o perfil ou as receitas. Tente novamente.",this.isLoading=!1,T([])))).subscribe())}navigateToRecipeDetail(e){this.router.navigate(["/receita-detalhe",e])}onProfileFileSelected(e){return x(this,null,function*(){let i=e.target;if(i.files&&i.files[0]){let t=i.files[0];if(!t.type.startsWith("image/")){alert("Por favor, selecione um arquivo de imagem (JPG, PNG, GIF, etc.)."),this.selectedProfileFile=null,this.userPhotoUrl==="https://placehold.co/100x100"||!this.userPhotoUrl?this.profileImagePreviewUrl=null:this.profileImagePreviewUrl=this.userPhotoUrl;return}console.log(`Profile - onFileSelected: Tamanho original da imagem: ${t.size/1024} KB`);try{let c=new FileReader;c.readAsDataURL(t),c.onload=h=>x(this,null,function*(){var F;let M=(F=h.target)==null?void 0:F.result,P=yield this.imageCompress.compressFile(M,-1,70,70);console.log(`Profile - onFileSelected: Tamanho da imagem comprimida: ${this.imageCompress.byteCount(P)/1024} KB`);let d=this.base64ToFile(P,t.name,t.type);this.selectedProfileFile=d,this.profileImagePreviewUrl=P}),c.onerror=h=>{console.error("Profile - onFileSelected: Erro ao ler o arquivo:",h),alert("Erro ao carregar a imagem."),this.selectedProfileFile=null,this.userPhotoUrl==="https://placehold.co/100x100"||!this.userPhotoUrl?this.profileImagePreviewUrl=null:this.profileImagePreviewUrl=this.userPhotoUrl}}catch(c){console.error("Profile - onFileSelected: Erro durante a compress\xE3o da imagem:",c),alert("Erro ao processar a imagem. Tente uma imagem diferente."),this.selectedProfileFile=null,this.userPhotoUrl==="https://placehold.co/100x100"||!this.userPhotoUrl?this.profileImagePreviewUrl=null:this.profileImagePreviewUrl=this.userPhotoUrl}}else this.selectedProfileFile=null,this.userPhotoUrl==="https://placehold.co/100x100"||!this.userPhotoUrl?this.profileImagePreviewUrl=null:this.profileImagePreviewUrl=this.userPhotoUrl})}base64ToFile(e,i,t){let c=atob(e.split(",")[1]),h=new ArrayBuffer(c.length),M=new Uint8Array(h);for(let d=0;d<c.length;d++)M[d]=c.charCodeAt(d);let P=new Blob([h],{type:t});return new File([P],i,{type:t})}onSaveProfilePhoto(){return x(this,null,function*(){if(!this.currentUserId){alert("Erro: Usu\xE1rio n\xE3o logado. N\xE3o \xE9 poss\xEDvel salvar a foto.");return}if(!this.selectedProfileFile){alert("Por favor, selecione uma imagem para salvar.");return}try{let e=yield R(this.receitaService.uploadRecipeImage(this.selectedProfileFile));yield this.authService.updateUserPhotoUrl(this.currentUserId,e),this.userPhotoUrl=e,this.profileImagePreviewUrl=e,this.selectedProfileFile=null,alert("Foto de perfil atualizada com sucesso!")}catch(e){console.error("Erro ao salvar nova foto de perfil:",e),alert("Erro ao salvar a foto de perfil. Por favor, tente novamente.")}})}};n.\u0275fac=function(i){return new(i||n)(_(Y),_(Z),_(Q),_(oe))},n.\u0275cmp=N({type:n,selectors:[["app-profile"]],decls:24,vars:10,consts:[[1,"profile-page-wrapper"],[1,"page-content-scrollable"],[1,"container"],[1,"profile-content"],[1,"user-summary-wrapper"],[1,"grupo-formulario","upload-foto-perfil"],[1,"contorno"],["for","profileFoto",1,"upload-area-perfil"],["type","file","id","profileFoto","name","profileFoto","accept","image/png, image/jpeg, image/jpg",2,"display","none",3,"change"],["class","upload-icon-wrapper-perfil",4,"ngIf"],["class","imagem-preview-perfil","alt","Pr\xE9via da Foto de Perfil",3,"src",4,"ngIf"],["class","botao-salvar-foto-perfil",3,"click",4,"ngIf"],[1,"info"],[1,"name"],[1,"posts-count"],[1,"item-list-section-container"],["title","Minhas Receitas","iconClass","bi bi-book-fill"],["class","loading-message",4,"ngIf"],["class","error-message",4,"ngIf"],[4,"ngIf"],[1,"upload-icon-wrapper-perfil"],[1,"bi","bi-image"],[1,"bi","bi-plus-lg","upload-plus-icon-perfil"],["alt","Pr\xE9via da Foto de Perfil",1,"imagem-preview-perfil",3,"src"],[1,"botao-salvar-foto-perfil",3,"click"],[1,"loading-message"],[1,"error-message"],["class","recipes-grid",4,"ngIf"],["class","no-recipes-message",4,"ngIf"],[1,"recipes-grid"],["class","recipe-card",3,"click",4,"ngFor","ngForOf"],[1,"recipe-card",3,"click"],[1,"recipe-image-container"],[1,"recipe-image",3,"src","alt"],[1,"recipe-info"],[1,"recipe-title"],[1,"recipe-meta"],[1,"no-recipes-message"]],template:function(i,t){i&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"label",7)(8,"input",8),v("change",function(h){return t.onProfileFileSelected(h)}),l(),m(9,ie,3,0,"div",9)(10,ne,1,1,"img",10),l()()(),m(11,re,2,0,"button",11),s(12,"div",12)(13,"p",13),g(14),l(),s(15,"p",14),g(16),l()()(),s(17,"div",15),u(18,"app-item-list-section",16),l(),m(19,ae,2,0,"p",17)(20,le,2,1,"p",18)(21,ge,3,2,"ng-container",19),S(22,"async"),u(23,"app-feed-menu"),l()()()()),i&2&&(a(9),p("ngIf",!t.profileImagePreviewUrl),a(),p("ngIf",t.profileImagePreviewUrl),a(),p("ngIf",t.selectedProfileFile),a(3),C(t.userName||"Carregando..."),a(2),V("",t.postsCount||0," postagens feitas"),a(3),p("ngIf",t.isLoading),a(),p("ngIf",t.error),a(),p("ngIf",D(22,8,t.userRecipes$)))},dependencies:[J,G,q,K,H,ee,W,te,X],styles:['@charset "UTF-8";.profile-page-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#11110f;color:#f0f0f0;overflow:hidden}.page-header-container-custom[_ngcontent-%COMP%]{width:85%;margin:20px auto 0;box-sizing:border-box}.info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.page-content-scrollable[_ngcontent-%COMP%]{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:0;scrollbar-width:none}.page-content-scrollable[_ngcontent-%COMP%]::-webkit-scrollbar{width:0px;background:transparent}.container[_ngcontent-%COMP%]{max-width:85%;margin:30px auto;height:auto;display:flex;flex-direction:column;align-items:center;padding:0}.profile-content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:flex-start;padding-bottom:20px;width:100%;box-sizing:border-box}.user-summary-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;margin-bottom:20px}.posts-count[_ngcontent-%COMP%]{color:#f0f0f0;font-size:12px;font-family:Mulish,sans-serif;opacity:.8;margin-top:-10px}.upload-foto-perfil[_ngcontent-%COMP%]{margin-top:20px;width:100%;display:flex;flex-direction:column;align-items:center}.contorno[_ngcontent-%COMP%]{width:170px;height:170px;border-radius:50%;border:1px solid #AD2F33;box-shadow:0 0 0 2px #ad2f33;display:flex;justify-content:center;align-items:center;overflow:hidden;transition:border-color .2s ease,box-shadow .2s ease,transform .2s ease;margin-bottom:15px}.contorno[_ngcontent-%COMP%]:hover{border-color:#852427;box-shadow:0 0 0 3px #852427;transform:scale(1.02)}.upload-area-perfil[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:calc(100% - 10px);height:calc(100% - 10px);background-color:#1d1d19;border-radius:50%;cursor:pointer;position:relative;overflow:hidden}.upload-area-perfil[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.upload-icon-wrapper-perfil[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:100%;color:#404040;font-size:4em}.upload-icon-wrapper-perfil[_ngcontent-%COMP%]   .bi-image[_ngcontent-%COMP%]{font-size:40px}.upload-plus-icon-perfil[_ngcontent-%COMP%]{position:absolute;bottom:25%;right:23%;font-size:15px;color:#f0f0f0;background-color:#ad2f33;border-radius:50%;padding:5px;line-height:1}.imagem-preview-perfil[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:cover;border-radius:50%;z-index:2}.botao-salvar-foto-perfil[_ngcontent-%COMP%]{background-color:#ad2f33;color:#f0f0f0;padding:10px 20px;border-radius:8px;border:none;cursor:pointer;font-size:14px;font-weight:700;transition:background-color .2s ease;width:auto}.botao-salvar-foto-perfil[_ngcontent-%COMP%]:hover{background-color:#992a2d}.loading-message[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%], .no-recipes-message[_ngcontent-%COMP%]{color:#f0f0f0;font-size:16px;padding:20px;margin-top:20px;width:100%;max-width:400px;text-align:center;align-self:center}.recipes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:30px;width:100%;padding-bottom:20px;box-sizing:border-box}.recipe-card[_ngcontent-%COMP%]{width:100%;overflow:hidden;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease;border-radius:14px}.recipe-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 25px #0009}.recipe-image-container[_ngcontent-%COMP%]{width:100%;height:25vh;overflow:hidden;border-radius:14px}.recipe-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.recipe-info[_ngcontent-%COMP%]{margin-top:15px;padding:0 5px;display:flex;flex-direction:column;gap:5px}.recipe-title[_ngcontent-%COMP%]{color:#f0f0f0;font-size:16px;font-family:Mulish,sans-serif;margin:0}.recipe-meta[_ngcontent-%COMP%]{color:#f0f0f0;font-size:12px;font-family:Mulish,sans-serif;opacity:.8}app-feed-menu[_ngcontent-%COMP%]{width:100%;align-self:center;margin-top:30px}@media (max-width: 768px){.page-header-container-custom[_ngcontent-%COMP%], .profile-content[_ngcontent-%COMP%]{width:95%}.contorno[_ngcontent-%COMP%]{width:130px;height:130px}.botao-salvar-foto-perfil[_ngcontent-%COMP%]{padding:8px 15px;font-size:12px}}.ion-palette-high-contrast[_nghost-%COMP%]   .profile-page-wrapper[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .profile-page-wrapper[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .page-content-scrollable[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .page-content-scrollable[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .profile-content[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .profile-content[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .recipes-grid[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .recipes-grid[_ngcontent-%COMP%]{background-color:#000!important;color:#fff!important}.ion-palette-high-contrast[_nghost-%COMP%]   .posts-count[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .posts-count[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .recipe-title[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .recipe-title[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .recipe-meta[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .recipe-meta[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .loading-message[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .loading-message[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .error-message[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .error-message[_ngcontent-%COMP%], .ion-palette-high-contrast[_nghost-%COMP%]   .no-recipes-message[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .no-recipes-message[_ngcontent-%COMP%]{color:#fff!important}.ion-palette-high-contrast[_nghost-%COMP%]   .contorno[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .contorno[_ngcontent-%COMP%]{border-color:#fff!important;box-shadow:0 0 0 2px #fff!important}.ion-palette-high-contrast[_nghost-%COMP%]   .upload-area-perfil[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .upload-area-perfil[_ngcontent-%COMP%]{background-color:#222!important}.ion-palette-high-contrast[_nghost-%COMP%]   .upload-plus-icon-perfil[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .upload-plus-icon-perfil[_ngcontent-%COMP%]{background-color:#fff!important;color:#000!important}.ion-palette-high-contrast[_nghost-%COMP%]   .botao-salvar-foto-perfil[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .botao-salvar-foto-perfil[_ngcontent-%COMP%]{background-color:#fff!important;color:#000!important}.ion-palette-high-contrast[_nghost-%COMP%]   .botao-salvar-foto-perfil[_ngcontent-%COMP%]:hover, .ion-palette-high-contrast   [_nghost-%COMP%]   .botao-salvar-foto-perfil[_ngcontent-%COMP%]:hover{background-color:#fff!important}.ion-palette-high-contrast[_nghost-%COMP%]   .recipe-card[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .recipe-card[_ngcontent-%COMP%]{background-color:#111!important;border:1px solid #444!important}.ion-palette-high-contrast[_nghost-%COMP%]   .recipe-card[_ngcontent-%COMP%]:hover, .ion-palette-high-contrast   [_nghost-%COMP%]   .recipe-card[_ngcontent-%COMP%]:hover{box-shadow:0 0 0 2px #fff!important}.ion-palette-high-contrast[_nghost-%COMP%]   .recipe-image-container[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .recipe-image-container[_ngcontent-%COMP%]{border-radius:14px!important}.ion-palette-high-contrast[_nghost-%COMP%]   .recipe-info[_ngcontent-%COMP%], .ion-palette-high-contrast   [_nghost-%COMP%]   .recipe-info[_ngcontent-%COMP%]{color:#fff!important}']});let o=n;return o})();export{Se as ProfilePage};
